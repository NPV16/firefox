[supervisord]
nodaemon=true
logfile=/tmp/supervisord.log
logfile_maxbytes=1MB
pidfile=/tmp/supervisord.pid

; 1. 虚拟X11显示服务器
[program:xvfb]
command=/usr/bin/Xvfb :99 -screen 0 1280x720x24 -ac +extension RANDR
autorestart=true
priority=100
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

; 2. 轻量窗口管理器
[program:jwm]
command=/usr/bin/jwm -display :99
autorestart=true
priority=200
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

; 3. VNC服务器（共享模式，无密码）
[program:x11vnc]
command=/usr/bin/x11vnc -display :99 -forever -shared -nopw -noxdamage
autorestart=true
priority=300
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

; 4. Web VNC 代理 (noVNC)
[program:novnc]
command=/usr/bin/websockify --web /usr/share/novnc 6080 localhost:5900
autorestart=true
priority=400
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

; 5. Firefox浏览器（可根据需要设置是否默认启动）
[program:firefox]
command=/usr/bin/firefox --display=:99
; 如果你不想让Firefox随容器启动而自动打开，可以将autorestart设为false并注释command
; 或者通过环境变量控制
autorestart=true
priority=500
user=firefox-user
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
